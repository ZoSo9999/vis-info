<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Albero</title>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <style>
    .node {
      fill: #ccc;
      stroke: #fff;
      stroke-width: 2px;
    }
    .link {
      fill: none;
      stroke: #999;
      stroke-opacity: 0.6;
      stroke-width: 2px;
    }
  </style>
</head>
<body>
  <svg width="500" height="500"></svg>

  <script>
    var nodes = [
      { id: 1 },
      { id: 2 },
      { id: 3 },
      { id: 4 },
      { id: 5 }
      // Aggiungi altri nodi se necessario
    ];

    var links = [
      { source: 1, target: 2, action: 1 },
      { source: 1, target: 3, action: 2 },
      { source: 3, target: 4, action: 1 },
      { source: 3, target: 5, action: 2 }
      // Aggiungi altri link se necessario
    ];

    drawTree(nodes, links);

    function drawTree(nodes, links) {
      var width = 500;
      var height = 500;

      var tree = d3.layout.tree()
        .size([width, height]);

      var diagonal = d3.svg.diagonal()
        .projection(function(d) { return [d.y, d.x]; });

      var svg = d3.select("svg")
        .append("g")
        .attr("transform", "translate(50, 50)");

      var root = nodes[0];

// Creazione della gerarchia dei nodi
var nodeById = d3.map();
nodes.forEach(function(node) {
  node.children = []; // Inizializza 'children' come un array vuoto
  nodeById.set(node.id, node);
});
links.forEach(function(link) {
  var parent = nodeById.get(link.source);
  var child = nodeById.get(link.target);
  if (!parent.children) {
    parent.children = []; // Inizializza 'children' come un array vuoto se non Ã¨ ancora definito
  }
  parent.children.push(child);
});


      var nodes = tree.nodes(root);
      var links = tree.links(nodes);

      var link = svg.selectAll(".link")
        .data(links)
        .enter().append("path")
        .attr("class", "link")
        .attr("d", diagonal);

      var node = svg.selectAll(".node")
        .data(nodes)
        .enter().append("circle")
        .attr("class", "node")
        .attr("r", 4)
        .attr("cx", function(d) { return d.y; })
        .attr("cy", function(d) { return d.x; });

      var text = svg.selectAll(".text")
        .data(nodes)
        .enter().append("text")
        .attr("class", "text")
        .attr("x", function(d) { return d.y + 10; })
        .attr("y", function(d) { return d.x; })
        .text(function(d) { return d.id; });
    }
  </script>
</body>
</html>
